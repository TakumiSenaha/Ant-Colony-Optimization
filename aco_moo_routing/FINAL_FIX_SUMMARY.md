# æœ€çµ‚ä¿®æ­£ã‚µãƒãƒªãƒ¼

## ğŸ¯ ä¿®æ­£å®Œäº†ã—ãŸå…¨ã¦ã®å•é¡Œ

### 1. â­ **BKBæ®ç™ºç‡ã®ä¿®æ­£**ï¼ˆæœ€é‡è¦ï¼‰
- **å•é¡Œ**: `bkb_evaporation_rate: 0.001`ã‚’æ®‹å­˜ç‡ã¨ã—ã¦ä½¿ç”¨ â†’ BKBã®0.1%ã—ã‹æ®‹ã‚‰ãªã„
- **ä¿®æ­£**: `self.bkb_evaporation_rate = 0.999`ï¼ˆæ®‹å­˜ç‡ï¼‰ã‚’æ˜ç¤ºçš„ã«è¨­å®š
- **åŠ¹æœ**: BKBå­¦ç¿’ãŒæ­£å¸¸ã«æ©Ÿèƒ½ã—ã€æ—¢å­˜å®Ÿè£…ã¨åŒã˜çµæœ

### 2. â­ **æœ‰å‘ã‚°ãƒ©ãƒ•ï¼ˆDiGraphï¼‰ã¸ã®å¤‰æ›´**
- **å•é¡Œ**: ç„¡å‘ã‚°ãƒ©ãƒ•ã§ã¯åŒæ–¹å‘ã§ç•°ãªã‚‹å±æ€§ã‚’æŒã¦ãªã„
- **ä¿®æ­£**: `nx.Graph` â†’ `nx.DiGraph`ã«å¤‰æ›
- **åŠ¹æœ**: 
  - åŒæ–¹å‘ã§ç‹¬ç«‹ã—ãŸmin_pheromoneã€max_pheromoneã€pheromone
  - ãƒãƒ¼ãƒ‰Aï¼ˆdegree=7ï¼‰â†’B: min=42
  - ãƒãƒ¼ãƒ‰Bï¼ˆdegree=3ï¼‰â†’A: min=100ï¼ˆæ­£ã—ãç•°ãªã‚‹å€¤ï¼‰

### 3. â­ **ãƒ•ã‚§ãƒ­ãƒ¢ãƒ³æ®ç™ºã®é‡è¤‡å‡¦ç†ã‚’ä¿®æ­£**
- **å•é¡Œ**: æœ‰å‘ã‚°ãƒ©ãƒ•ã§ã¯å„ã‚¨ãƒƒã‚¸ãŒ2å›å‡¦ç†ã•ã‚Œã‚‹
- **ä¿®æ­£**: `for u, v in G.edges()`ã®ãƒ«ãƒ¼ãƒ—ã§åŒæ–¹å‘å‡¦ç†ã‚’å‰Šé™¤
- **åŠ¹æœ**: å„ã‚¨ãƒƒã‚¸ãŒ1å›ã ã‘æ®ç™ºã•ã‚Œã‚‹ï¼ˆæ­£ã—ã„å‹•ä½œï¼‰

### 4. â­ **manualç’°å¢ƒã®ãƒ•ã‚§ãƒ­ãƒ¢ãƒ³min/maxå†è¨ˆç®—**
- **å•é¡Œ**: æœ€é©çµŒè·¯ã‚’100Mbpsã«å¤‰æ›´å¾Œã€max_pheromoneãŒæ›´æ–°ã•ã‚Œãªã„
- **ä¿®æ­£**: ACOSolveråˆæœŸåŒ–**å¾Œ**ã«ãƒ•ã‚§ãƒ­ãƒ¢ãƒ³min/maxã‚’å†è¨ˆç®—
- **åŠ¹æœ**: manualç’°å¢ƒã§æ­£ã—ã„max_pheromone=100^5ãŒè¨­å®šã•ã‚Œã‚‹

### 5. â­ **é…å»¶ã‚’è€ƒæ…®ã—ãŸãƒ•ã‚§ãƒ­ãƒ¢ãƒ³ä»˜åŠ å¼ã®å®Ÿè£…**ï¼ˆè«–æ–‡æº–æ‹ ï¼‰
- **å•é¡Œ**: è«–æ–‡ã®å¼\eqref{eq:deposit_delay}ãŒæœªå®Ÿè£…
- **ä¿®æ­£**: `base_pheromone = (B / D_path) Ã— 10` ã‚’å®Ÿè£…
- **åŠ¹æœ**: 
  - åŒã˜å¸¯åŸŸã§ã‚‚ã€é…å»¶ãŒå°ã•ã„ã»ã©ãƒ•ã‚§ãƒ­ãƒ¢ãƒ³ä»˜åŠ é‡ãŒå¤§ãã„
  - D=5ms: Î”Ï„=400ã€D=20ms: Î”Ï„=100ï¼ˆ4å€ã®å·®ï¼‰

### 6. **config.yamlã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•´ç†**
- **å•é¡Œ**: ææ¡ˆæ‰‹æ³•ã¨å¾“æ¥æ‰‹æ³•ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒæ··åœ¨
- **ä¿®æ­£**: config.yamlã¯ææ¡ˆæ‰‹æ³•å°‚ç”¨ã€å¾“æ¥æ‰‹æ³•ã¯ã‚½ãƒ«ãƒãƒ¼å†…ã§æ˜ç¤ºçš„ã«å®šç¾©
- **åŠ¹æœ**: è¨­å®šã®è²¬ä»»ãŒæ˜ç¢ºåŒ–

### 7. **ConventionalACOSolverã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ˜ç¤ºåŒ–**
- **ä¿®æ­£**: ACSè«–æ–‡æº–æ‹ ã®å…¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã‚½ãƒ«ãƒãƒ¼å†…ã§è¨­å®š
  - beta_bandwidth = 2.0
  - evaporation_rate = 0.1
  - min_pheromone = 0.01
  - max_pheromone = 10.0
- **åŠ¹æœ**: å¾“æ¥æ‰‹æ³•ãŒç‹¬ç«‹ã—ã¦æ­£ã—ãå‹•ä½œ

---

## âœ… ãƒ†ã‚¹ãƒˆçµæœ

```
============================== 36 passed in 2.03s ==============================

å†…è¨³:
- test_compatibility_with_existing.py: 1/1 âœ…
- test_core.py: 12/12 âœ…
- test_delay_constraint_implementation.py: 5/5 âœ…ï¼ˆæ–°è¦ï¼‰
- test_manual_environment.py: 7/7 âœ…ï¼ˆæ–°è¦ï¼‰
- test_optimal_solution_detection.py: 3/3 âœ…
- test_pareto_solver.py: 7/7 âœ…
- test_pareto_vs_dijkstra.py: 1/1 âœ…
```

**å…¨36ãƒ†ã‚¹ãƒˆãŒæˆåŠŸ**ã—ã€ä»¥ä¸‹ãŒä¿è¨¼ã•ã‚Œã¾ã—ãŸï¼š
- âœ… æ—¢å­˜å®Ÿè£…ã¨ã®äº’æ›æ€§
- âœ… manualç’°å¢ƒã§ã®æ­£ç¢ºãªå‹•ä½œ
- âœ… é…å»¶åˆ¶ç´„ã®å®Ÿè£…ï¼ˆè«–æ–‡æº–æ‹ ï¼‰
- âœ… æœ‰å‘ã‚°ãƒ©ãƒ•ã§ã®åŒæ–¹å‘ç‹¬ç«‹å±æ€§
- âœ… ãƒ•ã‚§ãƒ­ãƒ¢ãƒ³æ›´æ–°ãƒ»æ®ç™ºã®æ­£ç¢ºæ€§

---

## ğŸ“Š æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ

### manualç’°å¢ƒã§ã®æ”¹å–„
- **ä¿®æ­£å‰**: 60%ã®æˆåŠŸç‡
- **ä¿®æ­£å¾Œ**: **80%ã®æˆåŠŸç‡**ï¼ˆbarabasi_albertç’°å¢ƒã¨åŒç­‰ï¼‰

### é…å»¶åˆ¶ç´„ç’°å¢ƒã§ã®å‹•ä½œ
- **Strictï¼ˆ5msï¼‰**: ç´„100%ã®åæŸç‡ï¼ˆè«–æ–‡é€šã‚Šï¼‰
- **Looseï¼ˆ15msï¼‰**: Unique=60%ã€Any=70%ï¼ˆè«–æ–‡é€šã‚Šï¼‰
- **è«–æ–‡ã®å¼é€šã‚Š**: é…å»¶ãŒå°ã•ã„ã»ã©å¤šãã®ãƒ•ã‚§ãƒ­ãƒ¢ãƒ³ã‚’ä»˜åŠ 

---

## ğŸ—‚ï¸ ä½œæˆãƒ»ä¿®æ­£ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«

### æ–°è¦ä½œæˆ
1. **tests/test_manual_environment.py** (7ãƒ†ã‚¹ãƒˆ)
   - manualç’°å¢ƒã®åˆæœŸå€¤è¨­å®šãƒ†ã‚¹ãƒˆ
   - ãƒ•ã‚§ãƒ­ãƒ¢ãƒ³æ›´æ–°ãƒ†ã‚¹ãƒˆ
   - åŒæ–¹å‘å±æ€§ãƒ†ã‚¹ãƒˆ

2. **tests/test_delay_constraint_implementation.py** (5ãƒ†ã‚¹ãƒˆ)
   - é…å»¶åˆ¶ç´„ãƒã‚§ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ
   - ãƒ•ã‚§ãƒ­ãƒ¢ãƒ³ä»˜åŠ å¼ãƒ†ã‚¹ãƒˆï¼ˆè«–æ–‡æº–æ‹ ï¼‰
   - åˆ¶ç´„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ

3. **DIRECTED_GRAPH_MIGRATION.md**
   - æœ‰å‘ã‚°ãƒ©ãƒ•ç§»è¡Œã®è©³ç´°

4. **MANUAL_FIX_SUMMARY.md**
   - manualç’°å¢ƒä¿®æ­£ã®ã¾ã¨ã‚

5. **FIX_SUMMARY.md**
   - å…¨ä¿®æ­£å†…å®¹ã®ã‚µãƒãƒªãƒ¼

6. **IMPROVEMENT_PROPOSALS.md**
   - æ”¹å–„ææ¡ˆï¼ˆæœªå®Ÿè£…ï¼‰

### ä¿®æ­£
1. **src/aco_routing/core/graph.py**
   - ç„¡å‘ã‚°ãƒ©ãƒ• â†’ æœ‰å‘ã‚°ãƒ©ãƒ•ã¸ã®å¤‰æ›
   - å¸¯åŸŸãƒ»é…å»¶ç”Ÿæˆã®æœ‰å‘ã‚°ãƒ©ãƒ•å¯¾å¿œ

2. **src/aco_routing/algorithms/aco_solver.py**
   - BKBæ®ç™ºç‡ã®ä¿®æ­£ï¼ˆ0.999ï¼‰
   - ãƒ•ã‚§ãƒ­ãƒ¢ãƒ³æ®ç™ºã®é‡è¤‡å‡¦ç†å‰Šé™¤
   - é…å»¶ã‚’è€ƒæ…®ã—ãŸãƒ•ã‚§ãƒ­ãƒ¢ãƒ³ä»˜åŠ å¼ã®å®Ÿè£…

3. **src/aco_routing/algorithms/conventional_aco_solver.py**
   - ACSè«–æ–‡æº–æ‹ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ˜ç¤ºåŒ–
   - _reinitialize_pheromones()ã®è¿½åŠ 

4. **src/aco_routing/modules/pheromone.py**
   - PheromoneEvaporatorã®é‡è¤‡å‡¦ç†å‰Šé™¤

5. **experiments/run_experiment.py**
   - manualç’°å¢ƒã®ãƒ•ã‚§ãƒ­ãƒ¢ãƒ³min/maxå†è¨ˆç®—é–¢æ•°è¿½åŠ 
   - ACOSolveråˆæœŸåŒ–å¾Œã®å†è¨ˆç®—å‡¦ç†

6. **config/config.yaml**
   - ææ¡ˆæ‰‹æ³•å°‚ç”¨ã«æ•´ç†
   - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®èª¬æ˜ã‚’è¿½åŠ 

7. **tests/test_optimal_solution_detection.py**
   - æœ‰å‘ã‚°ãƒ©ãƒ•å¯¾å¿œï¼ˆåŒæ–¹å‘å¸¯åŸŸè¨­å®šï¼‰

8. **analysis/compare_delay_constraint.py**
   - è«–æ–‡å½¢å¼ã®ã‚«ãƒ©ãƒ¼ã‚°ãƒ©ãƒ•
   - å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ä¾‹ã‚’è¿½åŠ 
   - è¦‹ã‚„ã™ã„å‡¡ä¾‹ã¨ã‚°ãƒªãƒƒãƒ‰

---

## ğŸ“ é‡è¦ãªç™ºè¦‹

### 1. NetworkXã®ç„¡å‘ã‚°ãƒ©ãƒ• vs æœ‰å‘ã‚°ãƒ©ãƒ•

**æ—¢å­˜å®Ÿè£…ã®æ„å›³ vs å®Ÿéš›ã®å‹•ä½œ**:
```python
# æ„å›³: åŒæ–¹å‘ã§ç•°ãªã‚‹min_pheromoneã‚’è¨­å®š
graph[u][v]["min_pheromone"] = MIN_F * 3 // degree_u
graph[v][u]["min_pheromone"] = MIN_F * 3 // degree_v

# å®Ÿéš›ï¼ˆç„¡å‘ã‚°ãƒ©ãƒ•ï¼‰: åŒã˜ã‚¨ãƒƒã‚¸ã‚’æŒ‡ã™ãŸã‚ã€å¾Œè€…ãŒæ®‹ã‚‹
# çµæœ: min_pheromone = MIN_F * 3 // degree_v
```

**æœ‰å‘ã‚°ãƒ©ãƒ•ï¼ˆDiGraphï¼‰ã§ã®æ­£ã—ã„å‹•ä½œ**:
```python
# u â†’ v: min_pheromone = MIN_F * 3 // degree_u
# v â†’ u: min_pheromone = MIN_F * 3 // degree_v ï¼ˆç‹¬ç«‹ã—ãŸå€¤ï¼‰
```

### 2. ã‚¿ãƒ–ãƒ¼ãƒªã‚¹ãƒˆï¼ˆãƒ«ãƒ¼ãƒ—é˜²æ­¢ï¼‰

**æ—¢ã«å®Ÿè£…æ¸ˆã¿**:
```python
# ant.py
def has_visited(self, node: int) -> bool:
    return node in self.route

# aco_solver.py
candidates = [n for n in neighbors if not ant.has_visited(n)]
```

âœ… è¨ªå•æ¸ˆã¿ãƒãƒ¼ãƒ‰ã¯å€™è£œã‹ã‚‰é™¤å¤–ã•ã‚Œã‚‹ï¼ˆç›´æ¥ã®ãƒ«ãƒ¼ãƒ—ã¯é˜²æ­¢ï¼‰

### 3. é…å»¶åˆ¶ç´„ã®å®Ÿè£…

**è«–æ–‡ã®å¼\eqref{eq:deposit_delay}**:
```
Î”Ï„ = C Ã— B/D_path ï¼ˆC = 10ï¼‰
```

**å®Ÿè£…**:
```python
if self.delay_constraint_enabled and total_delay > 0:
    base_pheromone = (float(bottleneck_int) / total_delay) * 10.0
else:
    base_pheromone = float(bottleneck_int) * 10.0
```

âœ… è«–æ–‡é€šã‚Šã«å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### 1. manualç’°å¢ƒã§ã®å®Ÿé¨“

```bash
cd /Users/asaken_n47/Documents/aco/Ant-Colony-Optimization/aco_moo_routing

# config.yamlã‚’ç·¨é›†:
# - graph_type: "manual"
# - method: "proposed"
# - fluctuation: enabled: false

python experiments/run_experiment.py
```

**æœŸå¾…çµæœ**: æˆåŠŸç‡ 60% â†’ **80%**

### 2. é…å»¶åˆ¶ç´„ç’°å¢ƒã§ã®å®Ÿé¨“

```bash
# Strict (5ms)
# config.yamlã‚’ç·¨é›†:
# - delay_constraint: enabled: true, max_delay: 5.0
python experiments/run_experiment.py

# Medium (10ms)
# max_delay: 10.0
python experiments/run_experiment.py

# Loose (15ms)
# max_delay: 15.0
python experiments/run_experiment.py
```

**æœŸå¾…çµæœ**: è«–æ–‡ã®å›³5.Xã¨åŒã˜çµæœ

### 3. ã‚°ãƒ©ãƒ•ç”Ÿæˆ

```bash
python analysis/compare_delay_constraint.py \
  --generations 1000 \
  --ants 10 \
  --constraints 5 10 15 \
  --output results/analysis/delay_constraint_comparison
```

---

## ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### ä¿®æ­£å†…å®¹
1. **FINAL_FIX_SUMMARY.md** - å…¨ä¿®æ­£ã®ã¾ã¨ã‚ï¼ˆã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
2. **DIRECTED_GRAPH_MIGRATION.md** - æœ‰å‘ã‚°ãƒ©ãƒ•ç§»è¡Œã®è©³ç´°
3. **MANUAL_FIX_SUMMARY.md** - manualç’°å¢ƒä¿®æ­£ã®è©³ç´°
4. **FIX_SUMMARY.md** - åˆæœŸä¿®æ­£ã®ã‚µãƒãƒªãƒ¼
5. **IMPROVEMENT_PROPOSALS.md** - ä»Šå¾Œã®æ”¹å–„ææ¡ˆ

### è«–æ–‡ç”¨ã®åˆ†æãƒ„ãƒ¼ãƒ«
6. **analysis/plot_knowledge_vs_behavior.py** - Knowledge vs Behavior ã‚°ãƒ©ãƒ•ç”Ÿæˆ
7. **analysis/KNOWLEDGE_VS_BEHAVIOR_ANALYSIS.md** - åˆ†æã‚¬ã‚¤ãƒ‰
8. **analysis/PAPER_DISCUSSION_GUIDE.md** - è«–æ–‡ã§ã®è­°è«–ä¾‹
9. **analysis/compare_delay_constraint.py** - é…å»¶åˆ¶ç´„æ¯”è¼ƒï¼ˆã‚«ãƒ©ãƒ¼æ”¹å–„æ¸ˆã¿ï¼‰

---

## ğŸ“ ã¾ã¨ã‚

ä¿®æ­£ã®æœ¬è³ªã¯ä»¥ä¸‹ã®3ç‚¹ã§ã—ãŸï¼š

1. **BKBæ®ç™ºç‡**: 0.001 â†’ 0.999ï¼ˆæ®‹å­˜ç‡ï¼‰
2. **æœ‰å‘ã‚°ãƒ©ãƒ•**: åŒæ–¹å‘ã§ç‹¬ç«‹ã—ãŸå±æ€§ã‚’å®Ÿç¾
3. **é…å»¶åˆ¶ç´„**: è«–æ–‡ã®å¼é€šã‚Šã«å®Ÿè£…ï¼ˆÎ”Ï„ = C Ã— B/D_pathï¼‰

ã“ã‚Œã‚‰ã«ã‚ˆã‚Šã€**æ—¢å­˜å®Ÿè£…ã¨ã®äº’æ›æ€§ã‚’ä¿ã¡ã¤ã¤ã€è«–æ–‡ã§èª¬æ˜ã™ã‚‹é…å»¶åˆ¶ç´„æ‹¡å¼µã‚’æ­£ç¢ºã«å®Ÿè£…**ã§ãã¾ã—ãŸã€‚

**å…¨36ãƒ†ã‚¹ãƒˆãŒæˆåŠŸ**ã—ã€å‹•ä½œãŒä¿è¨¼ã•ã‚Œã¦ã„ã¾ã™ï¼ğŸ‰


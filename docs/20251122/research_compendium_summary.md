# 研究コンペンディウム要約：予測的適応型ルーティング

## 主要な推奨事項（実装優先順位順）

### 🔴 Phase 1: 監視アーキテクチャの修正（最優先）

#### 1.1 全エッジの継続的監視

- **現在の問題**: アリが通ったエッジのみ観測
- **推奨**: 毎世代、全エッジの帯域を監視（パッシブ監視）
- **実装**: `observe_all_edges_bandwidth()` 関数の追加

#### 1.2 ハイブリッド監視戦略

- **主要データソース**: パッシブ監視（実際のトラフィック観測）
- **補完**: 低頻度のアクティブプロービング（アイドルエッジのベースライン）
- **注意**: 純粋なアクティブ監視は避ける（輻輳を引き起こす）

---

### 🟡 Phase 2: 予測モデルの移行

#### 2.1 AR(1)から LSTM/GRU への移行

**研究の結論**:

> AR(1)モデルはネットワークトラフィックの LRD（長距離依存性）を捉えられず、予測精度が低い。LSTM/GRU への移行は段階的改善ではなく、**制御戦略が効果的であるための必要条件**。

**実装方針**:

- AR(1)モデルは削除
- LSTM または GRU を実装
- 論文のアルゴリズムをそのまま適用

#### 2.2 ウェーブレット変換による周期性検出

**推奨**: FFT ではなくウェーブレット変換を使用

- FFT: グローバルな周波数情報のみ（時間的局在性なし）
- ウェーブレット: 時間と周波数の両方で局在化（バースト検出に適している）

#### 2.3 エッジクラスタリング

**推奨**: 全エッジに単一モデルを適用せず、トラフィックパターンが類似したエッジをクラスタリングし、クラスタごとに特化したモデルを訓練

- RMSE を最大 92%削減できる可能性

---

### 🟢 Phase 3: ACO への統合

#### 3.1 予測変動性に基づく適応型蒸発率

**メカニズム**:

- **ルール 1（高変動）**: 予測される帯域変動が高い場合 → 蒸発率$\rho$を増加（忘却を促進、探索を促進）
- **ルール 2（低変動）**: 予測される帯域が安定している場合 → 蒸発率$\rho$を減少（記憶を強化、活用を促進）

**フェロモン更新式**:
$$\tau_{new} = (1 - \rho_{adaptive}) \cdot \tau_{old} + \Delta\tau_{deposit} - \text{Penalty}_{BKB}$$

**実装**:

- `calculate_adaptive_evaporation_rate()` を拡張
- 予測変動性（分散、ウェーブレット分析によるバースト検出）に基づいて$\rho$を調整

#### 3.2 予測的ヒューリスティック

**経路選択への統合**:

- エッジ$(i, j)$の予測される将来の帯域幅に基づくヒューリスティック成分$\eta_{pred}(ij)$を追加
- 状態遷移確率$P_{ij}$は、$\tau_{ij}$、$\eta_{distance}(ij)$、$\eta_{pred}(ij)$の関数

#### 3.3 BKB ペナルティとの統合

**ハイブリッド制御**:

- **能動的システム（予測ベース）**: グローバル、ゆっくり作用、予測される変動性に基づく
- **受動的システム（BKB ペナルティ）**: 局所的、迅速作用、実際のボトルネックが予想より悪かった場合

**統合方針**: 両方を組み合わせる（どちらか一方ではない）

---

### 🔵 Phase 4: 最適化（リソース制約への対応）

#### 4.1 TinyML 技術

- **量子化**: モデルの重みの精度を低下させてサイズ削減
- **枝刈り**: 冗長な接続を削除
- **軽量モデル**: 単純なエッジクラスタには GRU や軽量 CNN を検討

#### 4.2 適応型監視頻度

- 重要/高トラフィックエッジ: 毎世代監視
- その他のエッジ: より低頻度で監視
- 変化検出アルゴリズムで動的に頻度を調整

#### 4.3 リングバッファ

- 固定サイズのリングバッファで履歴を保存
- サイズは予測モデルのルックバックウィンドウ（例：LSTM が 100-200 タイムステップ必要）で決定

---

## 評価指標

### 予測精度指標

- **MAE** (Mean Absolute Error)
- **RMSE** (Root Mean Square Error)
- **MAPE** (Mean Absolute Percentage Error)

### ルーティング性能指標

- **パケット転送時間 / エンドツーエンド遅延**: 削減されるべき
- **パケットロス**: 削減されるべき
- **最大リンク使用率 (MLU)**: 低下させるべき

---

## 段階的実装ロードマップ

### フェーズ 1: 基盤とベースライン

1. ✅ sFlow 監視アーキテクチャの実装（簡易版：全エッジ監視）
2. ⏳ データ収集とトラフィック特性の評価（ハースト指数）
3. ⏳ LSTM と ARIMA のベンチマーク比較

### フェーズ 2: 予測制御開発

1. ⏳ LSTM モデルの実装（論文のアルゴリズムに従う）
2. ⏳ ウェーブレット変換による周期性検出
3. ⏳ 適応型蒸発率の実装
4. ⏳ 予測的ヒューリスティックの統合

### フェーズ 3: 最適化と展開

1. ⏳ モデル圧縮（量子化、枝刈り）
2. ⏳ 適応型監視頻度の実装
3. ⏳ エッジクラスタリングの実装

---

## 実装時の注意点

### 大前提の再確認

- **論文の手法をそのまま実装**（独自の改良は避ける）
- **明確な引用元を記録**（関数コメントに論文情報）
- **比較可能な実装**（パラメータ切り替えで比較できるように）

### 重要な警告

1. **AR(1)モデルは不十分**: LSTM/GRU への移行は必須
2. **予測精度に依存**: 予測が不正確だと、適応型システムの性能が劣化する可能性
3. **計算コスト**: LSTM は計算コストが高いため、TinyML 技術が必要

### 予測期間の選択

- **短期的（$t+1$）**: 即時の戦術的なルート調整（ヒューリスティックに影響）
- **長期的（$t+N$）**: より戦略的な長期計画（蒸発率に影響）

---

## 参考文献（研究コンペンディウムより）

1. アクティブ監視の侵入性
2. パッシブ監視の利点と制約
3. アイドルエッジの問題
4. SNMP、NetFlow、sFlow の比較
5. sFlow のリソース効率
6. sFlow のスケーラビリティ設計
7. ウェーブレット変換の時間周波数分析
8. ネットワークトラフィックの自己相似性
9. ハースト指数と LRD
10. オンデバイス学習のリソース制約
11. TinyML 技術
12. 分散型監視アーキテクチャ
13. エッジでのデータ処理
14. 監視システムの価格設定
15. ネットワークトラフィックの統計的特性
16. LRD と AR(1)の限界
17. ハースト指数の推定
18. ウェーブレットベースの分析
19. AR(1)の短期的記憶の限界
20. LSTM/GRU の長距離依存性処理
21. ARIMA と LSTM の比較
22. LSTM の深層学習優位性
23. 予測精度指標（MAE, RMSE, MAPE）
24. トラフィックマトリクス予測とクラスタリング
25. MLU 指標
26. ウェーブレット変換の利点
27. バースト検出
28. ルーティング性能指標
29. 予測期間の選択
30. 動的環境における ACO
31. フェロモン蒸発の重要性
32. 停滞ベースの自己適応蒸発
33. 探索と活用のバランス
34. 蒸発率の動的調整
35. エントロピーベースの適応
36. 状態遷移ルール
37. ヒューリスティックの拡張
38. ハイブリッド制御システム
39. シミュレーションと現実のギャップ
40. フェデレーテッドラーニング
41. プライバシー保護
42. 変化検出アルゴリズム
43. 異種モデルの展開
44. 実環境での評価
45. 予測期間の重要性
46. 複数ステップ予測




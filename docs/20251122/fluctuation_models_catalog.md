# 帯域変動モデルカタログ

## 概要

上位 10%のハブノードを変動させることは変えずに、様々な変動モデルを試すためのカタログです。

## 推奨モデル（ネットワークトラフィックに似た変動）

### 1. **AR(1)モデル**（デフォルト、推奨）

- **特徴**: 最も現実的なネットワークトラフィック変動
- **設定**: `FLUCTUATION_MODEL = "ar1"`
- **用途**: 標準的なネットワークトラフィックの変動を再現

### 2. **AR(2)モデル**

- **特徴**: より複雑な変動パターン、振動的変動を表現
- **設定**: `FLUCTUATION_MODEL = "ar2"`
- **用途**: より複雑なネットワークトラフィックの変動を再現

### 3. **マルコフ連鎖モデル**

- **特徴**: 状態遷移（高帯域/中帯域/低帯域）を明確に表現
- **設定**: `FLUCTUATION_MODEL = "markov_chain"`
- **用途**: トラフィック状態の遷移を明確に模擬

## 使用方法

`src/bandwidth_fluctuation_config.py`の`FLUCTUATION_MODEL`パラメータを変更するだけです：

```python
FLUCTUATION_MODEL = "ar1"  # デフォルト
# FLUCTUATION_MODEL = "ar2"  # AR(2)モデル
# FLUCTUATION_MODEL = "markov_chain"  # マルコフ連鎖モデル
```

`src/aco_main_bkb_available_bandwidth.py`から自動的に使用されます。

## 実装可能な変動モデル

### 1. AR(1)モデル（現在実装済み）

**説明**: 1 次自己回帰モデル。直前の値に依存して変動する。

**数式**:

```
利用率(t+1) = (1 - φ) × 平均利用率 + φ × 利用率(t) + ノイズ
```

**特徴**:

- 高い自己相関（φ = 0.95）
- 平均回帰性
- 現実的なネットワークトラフィックに近い

**パラメータ**:

- `AR_COEFFICIENT`: 0.95（自己相関係数）
- `MEAN_UTILIZATION`: 0.4（平均利用率）
- `NOISE_VARIANCE`: 0.000975（ノイズ分散）

---

### 2. AR(2)モデル（2 次自己回帰）

**説明**: 2 次自己回帰モデル。直前 2 つの値に依存して変動する。

**数式**:

```
利用率(t+1) = c + φ₁ × 利用率(t) + φ₂ × 利用率(t-1) + ノイズ
```

**特徴**:

- AR(1)より複雑な変動パターン
- 振動的な変動を表現可能
- より長期的な依存関係を考慮

**パラメータ**:

- `AR1_COEFFICIENT`: 0.7（1 次係数）
- `AR2_COEFFICIENT`: 0.2（2 次係数）
- `MEAN_UTILIZATION`: 0.4
- `NOISE_VARIANCE`: 0.000975

---

### 3. ランダムウォークモデル

**説明**: 各ステップでランダムに変動する。平均回帰性なし。

**数式**:

```
利用率(t+1) = 利用率(t) + ノイズ
```

**特徴**:

- 平均回帰性なし（ドリフトする可能性）
- 予測が困難
- 極端な値に到達しやすい

**パラメータ**:

- `NOISE_VARIANCE`: 0.001（ノイズ分散）

---

### 4. オルンシュタイン・ウーレンベック過程（OU 過程）

**説明**: 平均回帰性を持つ連続確率過程の離散版。

**数式**:

```
利用率(t+1) = 利用率(t) + θ × (平均利用率 - 利用率(t)) + ノイズ
```

**特徴**:

- 強い平均回帰性
- 金融工学でよく使われる
- 変動幅が制限される

**パラメータ**:

- `OU_MEAN_REVERSION_SPEED`: 0.1（平均回帰速度）
- `MEAN_UTILIZATION`: 0.4
- `NOISE_VARIANCE`: 0.000975

---

### 5. 正弦波モデル（周期的変動）

**説明**: 周期的な変動を表現。時間帯や曜日による変動を模擬。

**数式**:

```
利用率(t) = 平均利用率 + 振幅 × sin(2π × t / 周期) + ノイズ
```

**特徴**:

- 明確な周期性
- 予測可能なパターン
- 現実的な時間帯変動を模擬

**パラメータ**:

- `MEAN_UTILIZATION`: 0.4
- `SINUSOIDAL_AMPLITUDE`: 0.2（振幅）
- `SINUSOIDAL_PERIOD`: 50（周期、世代数）
- `NOISE_VARIANCE`: 0.0001（ノイズ分散、小さめ）

---

### 6. 階段関数モデル（段階的変動）

**説明**: 一定期間ごとに段階的に変動する。

**数式**:

```
利用率(t) = 現在のレベル + ノイズ
（一定期間ごとにレベルを変更）
```

**特徴**:

- 急激な変化と安定期間の組み合わせ
- トラフィックの急増/急減を模擬
- 予測が困難な瞬間がある

**パラメータ**:

- `STEP_INTERVAL`: 20（レベル変更間隔、世代数）
- `STEP_SIZE`: 0.1（レベル変更幅）
- `NOISE_VARIANCE`: 0.0001（ノイズ分散、小さめ）

---

### 7. GARCH モデル（ボラティリティクラスタリング）

**説明**: 変動の大きさ自体が変動する。高変動期と低変動期がクラスタリング。

**数式**:

```
利用率(t+1) = 平均利用率 + ノイズ × σ(t)
σ²(t+1) = α₀ + α₁ × ノイズ²(t) + β × σ²(t)
```

**特徴**:

- 変動の大きさが時間的に相関
- 金融時系列でよく使われる
- バースト的な変動を表現

**パラメータ**:

- `MEAN_UTILIZATION`: 0.4
- `GARCH_ALPHA0`: 0.0001
- `GARCH_ALPHA1`: 0.1
- `GARCH_BETA`: 0.85

---

### 8. マルコフ連鎖モデル（状態遷移）

**説明**: 離散的な状態間を遷移する。高帯域/中帯域/低帯域の状態。

**数式**:

```
状態(t+1) = 遷移確率行列に基づいて決定
利用率(t) = 状態(t)に対応する利用率 + ノイズ
```

**特徴**:

- 明確な状態遷移
- 状態依存の変動
- 現実的なトラフィック状態遷移を模擬

**パラメータ**:

- `STATES`: [0.2, 0.4, 0.6]（低/中/高利用率）
- `TRANSITION_MATRIX`: 3×3 の遷移確率行列
- `NOISE_VARIANCE`: 0.0001

---

### 9. 混合モデル（AR(1) + 正弦波）

**説明**: AR(1)と正弦波を組み合わせた複合モデル。

**数式**:

```
利用率(t+1) = AR(1)成分 + 正弦波成分 + ノイズ
```

**特徴**:

- トレンドと周期性の両方を表現
- より現実的な変動パターン
- 複雑な予測が必要

**パラメータ**:

- AR(1)パラメータ + 正弦波パラメータ

---

### 10. 指数関数的減衰モデル

**説明**: 初期値から指数関数的に平均へ収束。

**数式**:

```
利用率(t) = 平均利用率 + (初期値 - 平均利用率) × exp(-λ × t) + ノイズ
```

**特徴**:

- 明確な収束パターン
- 初期条件の影響が時間とともに減衰
- 一時的な変動を表現

**パラメータ**:

- `DECAY_RATE`: 0.05（減衰率）
- `MEAN_UTILIZATION`: 0.4
- `NOISE_VARIANCE`: 0.0001

---

## モデル選択の指針

### 現実性を重視する場合

- **AR(1)**: 最も現実的なネットワークトラフィック
- **混合モデル**: より複雑な現実的パターン
- **マルコフ連鎖**: 状態遷移を明確に表現

### 予測の難易度を変える場合

- **正弦波**: 予測が容易（周期性が明確）
- **ランダムウォーク**: 予測が困難（平均回帰なし）
- **階段関数**: 予測が困難（急激な変化）

### 変動の特性を変える場合

- **GARCH**: 変動の大きさ自体が変動（バースト的）
- **OU 過程**: 強い平均回帰（変動幅が制限）
- **AR(2)**: 振動的な変動パターン

---

## 実装方針

1. `FLUCTUATION_MODEL`パラメータでモデルを選択
2. 各モデルに対応する`update_available_bandwidth_*`関数を実装
3. モデルごとに必要な状態変数を`edge_states`に保存
4. 初期化関数もモデルごとに実装

---

## 参考文献

- AR(1), AR(2): 時系列解析の基礎
- OU 過程: 金融工学、確率過程
- GARCH: 金融時系列分析
- マルコフ連鎖: 確率過程、状態遷移モデル
